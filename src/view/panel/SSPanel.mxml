<?xml version="1.0" encoding="utf-8"?>
<!-- zengrong.net -->
<!-- 创建者:zrong(zrongzrong@gmail.com) -->
<!-- 创建时间：2011-8-9 -->
<!-- 预览创建或者打开的Sprite Sheet，并对其进行编辑、优化和保存 -->
<s:HGroup xmlns:fx="http://ns.adobe.com/mxml/2009" 
				   xmlns:s="library://ns.adobe.com/flex/spark" 
				   xmlns:mx="library://ns.adobe.com/flex/mx"
				   xmlns:comps="view.comps.*"
				   xmlns:widget="view.widget.*" >
	<s:BorderContainer id="leftPanelBG" width="320" height="100%" borderColor="0x878787" backgroundAlpha="0" enabled="false">
		<s:VGroup id="leftPanel" width="100%" height="100%" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5" horizontalAlign="center">
			<comps:FramesAndLabels id="framesAndLabels" width="100%" backgroundColor="0x696969"/>
			<widget:BuildSetting id="optPanel" width="100%" backgroundColor="0x696969" currentState="buildAndOpt" />
		</s:VGroup>
	</s:BorderContainer>
	<s:VScrollBar height="100%" viewport="{leftPanel}"/>
	<s:VGroup width="100%" height="100%">
		<s:TabBar width="100%" dataProvider="{previewVS}"/>
		<mx:ViewStack id="previewVS" width="100%" height="100%" creationPolicy="all">
			<s:NavigatorContent width="100%" height="100%">
				<s:label>{FxGettext.gettext("Sheet preview")}</s:label>
				<widget:BMPPreview id="sheetPreview" width="100%" height="100%"  borderColor="0x878787" backgroundAlpha="0"/>		
			</s:NavigatorContent>
			<comps:SSPreview id="aniPreview" width="100%" height="100%" />		
		</mx:ViewStack>
	</s:VGroup>
	<fx:Script>
	<![CDATA[
		import gnu.as3.gettext.FxGettext;
		import interf.IPreview;
		import vo.SaveVO;
		
		public function init($bmd:BitmapData):void
		{
			//从SpriteSheet中初始化Label和Frame
			sheetPreview.source = $bmd;
			leftPanelBG.enabled = true;
			//使用当前Sheet的宽高重置WH的相关值
			optPanel.whDDL.selectedIndex = 0;
			optPanel.whNS.value = $bmd.width;
		}
		
		public function destroy():void
		{
			sheetPreview.destroy();
		}
		
		/**
		 * 生成sheet图的背景色
		 */
		public function get bgColor():uint
		{
			return optPanel.bgColorPicker.selectedColor;
		}
		
		/**
		 * 是否透明
		 */
		public function get transparent():Boolean
		{
			return optPanel.transparentCB.selected;
		}

		/**
		 * 限制宽度（true）还是限制高度（false）
		 */
		public function get limitWidth():Boolean
		{
			return optPanel.whDDL.selectedIndex == 0;
		}
		
		/**
		 * 明确指定Sheet的宽度或高度
		 */
		public function get explicitSize():int
		{
			return optPanel.whNS.value;
		}
		
		/**
		 * 是否开启2的幂
		 */
		public function get powerOf2():Boolean
		{
			return optPanel.powerOf2CB.selected;
		}
		
		/**
		 * 是否开启正方形
		 */
		public function get square():Boolean
		{
			return optPanel.squareCB.selected;
		}
		
		public function get trim():Boolean
		{
			return optPanel.trimCB.selected;
		}
		
		public function get resetRect():Boolean
		{
			return optPanel.resetRectCB.selected;
		}

	]]>
	</fx:Script>
</s:HGroup>
